<div class="bg-image"></div>

<ion-header class="ion-no-border">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-back-button defaultHref="/home" color="light"></ion-back-button>
    </ion-buttons>
    <ion-title>Registrar Nuevo Pozo</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" class="transparent-content">
  
  <div class="form-container">
    <form #f="ngForm" (ngSubmit)="guardarPozo(f)">

      <div class="section-card">
        <div class="card-header">
          <ion-icon name="map-outline"></ion-icon>
          <h3>Ubicación e Identificación</h3>
        </div>
        
        <div class="input-wrapper">
          <label>Nombre del Pozo (*)</label>
          <div class="input-container" [class.error-border]="nombreModel.invalid && nombreModel.touched">
             <ion-item lines="none" class="transparent-item">
                <ion-input type="text" name="nombre" [(ngModel)]="pozo.nombre" #nombreModel="ngModel" required placeholder="Ej: Pozo Norte-01"></ion-input>
             </ion-item>
          </div>
          <div *ngIf="nombreModel.invalid && nombreModel.touched" class="error-msg">
            <ion-icon name="alert-circle"></ion-icon> Nombre requerido
          </div>
        </div>

        <div class="input-wrapper">
          <label>Latitud (GMS)</label>
          <div class="input-container">
             <ion-item lines="none" class="transparent-item">
                <ion-input type="number" name="latitud" [(ngModel)]="pozo.latitud" placeholder="Ej: 34.12345"></ion-input>
             </ion-item>
          </div>
        </div>

        <div class="input-wrapper">
          <label>Longitud (GMS)</label>
          <div class="input-container">
             <ion-item lines="none" class="transparent-item">
                <ion-input type="number" name="longitud" [(ngModel)]="pozo.longitud" placeholder="Ej: -118.98765"></ion-input>
             </ion-item>
          </div>
        </div>
      </div>

      <div class="section-card">
        <div class="card-header">
          <ion-icon name="construct-outline"></ion-icon>
          <h3>Especificaciones Técnicas</h3>
        </div>

        <div class="input-wrapper">
          <label>Profundidad Total (m) (*)</label>
          <div class="input-container" [class.error-border]="profundidadModel.invalid && profundidadModel.touched">
             <ion-item lines="none" class="transparent-item">
                <ion-input type="number" name="profundidadTotal" [(ngModel)]="pozo.profundidadTotal" #profundidadModel="ngModel" required placeholder="0.00"></ion-input>
             </ion-item>
          </div>
          <div *ngIf="profundidadModel.invalid && profundidadModel.touched" class="error-msg">
            <ion-icon name="alert-circle"></ion-icon> Dato requerido
          </div>
        </div>

        <div class="input-wrapper">
          <label>Diámetro (pulgadas)</label>
          <div class="input-container">
             <ion-item lines="none" class="transparent-item">
                <ion-input type="number" name="diametro" [(ngModel)]="pozo.diametro" placeholder="0.00"></ion-input>
             </ion-item>
          </div>
        </div>
      </div>

      <div class="section-card">
        <div class="card-header">
          <ion-icon name="pulse-outline"></ion-icon>
          <h3>Estado de Monitoreo</h3>
        </div>

        <div class="input-wrapper">
          <label>Vida útil restante (%) (*)</label>
          <div class="input-container" [class.error-border]="vidaModel.invalid && vidaModel.touched">
             <ion-item lines="none" class="transparent-item">
                <ion-input type="number" name="vidaUtilRestante" [(ngModel)]="pozo.vidaUtilRestante" #vidaModel="ngModel" required min="0" max="100" placeholder="0 - 100"></ion-input>
             </ion-item>
          </div>
          <div *ngIf="vidaModel.invalid && vidaModel.touched" class="error-msg">
            <ion-icon name="alert-circle"></ion-icon> Requerido (0-100)
          </div>
        </div>

        <div class="input-wrapper">
          <label>Fecha de Instalación (*)</label>
          <div class="input-container" [class.error-border]="fechaModel.invalid && fechaModel.touched">
             <ion-item lines="none" class="transparent-item">
                <ion-input type="date" name="fechaInstalacion" [(ngModel)]="pozo.fechaInstalacion" #fechaModel="ngModel" required></ion-input>
             </ion-item>
          </div>
          <div *ngIf="fechaModel.invalid && fechaModel.touched" class="error-msg">
             <ion-icon name="alert-circle"></ion-icon> Fecha requerida
          </div>
        </div>

        <div class="toggle-wrapper">
           <ion-item lines="none" class="transparent-item">
             <ion-label class="toggle-label">Pozo Activo / Operativo</ion-label>
             <ion-toggle name="activo" [(ngModel)]="pozo.activo" color="success"></ion-toggle>
           </ion-item>
        </div>
      </div>

      <ion-button 
        expand="block" 
        type="submit" 
        [disabled]="f.invalid || loading" 
        class="save-btn"
      >
        <span *ngIf="!loading">GUARDAR REGISTRO</span>
        <ion-spinner *ngIf="loading" name="crescent"></ion-spinner>
      </ion-button>

    </form>
  </div>
</ion-content>